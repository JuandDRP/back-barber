const a1_0x16121f=a1_0x16f6;function a1_0x1c9f(){const _0x3d71d3=['send','Imxix','Reserva\x20no\x20encontrada','/login','horas','YMWtk','deleteOne','arnsL','dmIje','Faltan\x20datos:\x20nombre\x20cliente,numero\x20celular,\x20barbero,\x20fecha\x20u\x20hora','35693cPQGLy','623742UfvuWR','qHZSW','jtOST','params','collection','Camilo','1433664mDBydB','ecWtN','buBbs','then','disponibilidades','Juan','PKBiS','ubnSR','post','use','bytVP','/disponibilidad','ZyBFl','5dgkbtj','OWgxO','deletedCount','107148XTBKZs','insertOne','/clientes','Faltan\x20datos','findOne','status','listen','dYfmi','body','tssKm','RUULs','Reserva\x20realizada\x20con\x20Ã©xito','express','Credenciales\x20invÃ¡lidas','json','hayaq','Faltan\x20datos:\x20barbero,\x20fecha,\x20hora\x20o\x20numeroCelular','kTSsz','toArray','No\x20hay\x20disponibilidad\x20configurada','/reservar','error','Horario\x20ya\x20reservado','IrSQg','map','log','./db','/disponibilidad/:barbero/:fecha','hora','10geKcpE','/eliminarReserva','Barbero\x20no\x20vÃ¡lido.\x20Solo\x20se\x20permiten\x20Juan\x20o\x20Camilo.','Error\x20al\x20eliminar\x20la\x20reserva','includes','updateOne','FXbWv','peluqueadas','811594KJkFOM','gcWbh','admin','Error\x20en\x20login:','EXunF','/reservas/:fecha','OhtuE','624957EAatEx','find','clientes','get','Error\x20al\x20eliminar\x20reserva:','kzInV','TPQGK','xVADb','307216zFfkvA'];a1_0x1c9f=function(){return _0x3d71d3;};return a1_0x1c9f();}(function(_0x5e4556,_0xf96056){const _0x179aa0=a1_0x16f6,_0x5af61d=_0x5e4556();while(!![]){try{const _0x5d174a=-parseInt(_0x179aa0(0x22c))/0x1*(parseInt(_0x179aa0(0x20a))/0x2)+parseInt(_0x179aa0(0x219))/0x3+-parseInt(_0x179aa0(0x243))/0x4+-parseInt(_0x179aa0(0x240))/0x5*(-parseInt(_0x179aa0(0x22d))/0x6)+-parseInt(_0x179aa0(0x212))/0x7+-parseInt(_0x179aa0(0x221))/0x8+parseInt(_0x179aa0(0x233))/0x9;if(_0x5d174a===_0xf96056)break;else _0x5af61d['push'](_0x5af61d['shift']());}catch(_0x29abca){_0x5af61d['push'](_0x5af61d['shift']());}}}(a1_0x1c9f,0x1b568));const express=require(a1_0x16121f(0x1f9)),app=express(),cors=require('cors'),conectarDB=require(a1_0x16121f(0x207));app[a1_0x16121f(0x23c)](cors()),app[a1_0x16121f(0x23c)](express[a1_0x16121f(0x1fb)]());function a1_0x16f6(_0x34896d,_0x10c752){const _0x1c9f13=a1_0x1c9f();return a1_0x16f6=function(_0x16f652,_0x5450c4){_0x16f652=_0x16f652-0x1ee;let _0x4bc455=_0x1c9f13[_0x16f652];return _0x4bc455;},a1_0x16f6(_0x34896d,_0x10c752);}let db,reservasCol,disponibilidadesCol,clientesCol;conectarDB()[a1_0x16121f(0x236)](_0x8d27c9=>{const _0x4dfb70=a1_0x16121f,_0x76ccbb={'hayaq':'3|2|0|1|4','qHZSW':_0x4dfb70(0x237),'PKBiS':_0x4dfb70(0x21b),'tssKm':'reservas'},_0x28307b=_0x76ccbb[_0x4dfb70(0x1fc)]['split']('|');let _0x881d8e=0x0;while(!![]){switch(_0x28307b[_0x881d8e++]){case'0':disponibilidadesCol=db['collection'](_0x76ccbb[_0x4dfb70(0x22e)]);continue;case'1':clientesCol=db[_0x4dfb70(0x231)](_0x76ccbb[_0x4dfb70(0x239)]);continue;case'2':reservasCol=db[_0x4dfb70(0x231)](_0x76ccbb[_0x4dfb70(0x1f6)]);continue;case'3':db=_0x8d27c9;continue;case'4':app[_0x4dfb70(0x1f3)](0xbb9,()=>{const _0x311f7a=_0x4dfb70;console[_0x311f7a(0x206)]('ðŸš€\x20Servidor\x20escuchando\x20en\x20http://localhost:3001');});continue;}break;}}),app[a1_0x16121f(0x21c)]('/',(_0x190eae,_0x310565)=>{const _0x25904e=a1_0x16121f,_0x7e1af0={'jtOST':'Hola\x20desde\x20Express\x20y\x20MongoDB\x20ðŸš€'};_0x310565[_0x25904e(0x222)](_0x7e1af0[_0x25904e(0x22f)]);}),app[a1_0x16121f(0x21c)](a1_0x16121f(0x208),async(_0x33f851,_0x4741f1)=>{const _0x315b1c=a1_0x16121f,_0x37f37e={'kTSsz':_0x315b1c(0x232),'gcWbh':_0x315b1c(0x20c),'RUULs':_0x315b1c(0x200)},{barbero:_0x1d091e,fecha:_0x2d6537}=_0x33f851[_0x315b1c(0x230)],_0xfb0c4c=['Juan',_0x37f37e[_0x315b1c(0x1fe)]];if(!_0xfb0c4c[_0x315b1c(0x20e)](_0x1d091e))return _0x4741f1[_0x315b1c(0x1f2)](0x190)[_0x315b1c(0x1fb)]({'error':_0x37f37e[_0x315b1c(0x213)]});const _0x55a776=await disponibilidadesCol[_0x315b1c(0x1f1)]({'barbero':_0x1d091e,'fecha':_0x2d6537});if(!_0x55a776)return _0x4741f1[_0x315b1c(0x1f2)](0x194)[_0x315b1c(0x1fb)]({'error':_0x37f37e[_0x315b1c(0x1f7)]});const _0x199b12=await reservasCol[_0x315b1c(0x21a)]({'barbero':_0x1d091e,'fecha':_0x2d6537})['toArray'](),_0x2c2141=_0x199b12[_0x315b1c(0x205)](_0x2f92c4=>_0x2f92c4[_0x315b1c(0x209)]),_0x3c8fd3=_0x55a776[_0x315b1c(0x226)]['filter'](_0x3beb7c=>!_0x2c2141['includes'](_0x3beb7c));_0x4741f1[_0x315b1c(0x1fb)]({'barbero':_0x1d091e,'fecha':_0x2d6537,'disponibles':_0x3c8fd3});}),app[a1_0x16121f(0x21c)](a1_0x16121f(0x1ef),async(_0x16ff75,_0x88f7a1)=>{const _0x1dab87=a1_0x16121f,_0x1a44f9={'drEOO':_0x1dab87(0x21b)},_0x47a158=await db[_0x1dab87(0x231)](_0x1a44f9['drEOO'])[_0x1dab87(0x21a)]({})[_0x1dab87(0x1ff)]();_0x88f7a1[_0x1dab87(0x1fb)](_0x47a158);}),app[a1_0x16121f(0x21c)](a1_0x16121f(0x217),async(_0x394f9f,_0x6ba470)=>{const _0x9dfa40=a1_0x16121f,_0x357030={'Imxix':'reservas'},{fecha:_0x8e530b}=_0x394f9f[_0x9dfa40(0x230)],_0x1220d6=await db[_0x9dfa40(0x231)](_0x357030[_0x9dfa40(0x223)])[_0x9dfa40(0x21a)]({'fecha':_0x8e530b})[_0x9dfa40(0x1ff)]();_0x6ba470[_0x9dfa40(0x1fb)](_0x1220d6);}),app['post'](a1_0x16121f(0x201),async(_0x4e1ca7,_0x4cde10)=>{const _0x45c9d3=a1_0x16121f,_0x108eef={'IrSQg':function(_0x41dfc4,_0x3fbacd){return _0x41dfc4||_0x3fbacd;},'kzInV':_0x45c9d3(0x22b),'dmIje':_0x45c9d3(0x238),'PVazW':_0x45c9d3(0x232),'eknAy':_0x45c9d3(0x20c),'ecWtN':_0x45c9d3(0x203),'ubnSR':function(_0xe4a3f2,_0x7d110e){return _0xe4a3f2>=_0x7d110e;},'HaGPf':function(_0x2b355d,_0x5a37c0){return _0x2b355d+_0x5a37c0;}},{nombreCliente:_0x1b2760,numeroCelular:_0x2228ca,barbero:_0x481ed5,fecha:_0x36b51f,hora:_0xb52a1e}=_0x4e1ca7[_0x45c9d3(0x1f5)];if(_0x108eef[_0x45c9d3(0x204)](!_0x1b2760,!_0x2228ca)||!_0x481ed5||!_0x36b51f||!_0xb52a1e)return _0x4cde10['status'](0x190)[_0x45c9d3(0x1fb)]({'error':_0x108eef[_0x45c9d3(0x21e)]});const _0x43c72a=[_0x108eef[_0x45c9d3(0x22a)],_0x108eef['PVazW']];if(!_0x43c72a[_0x45c9d3(0x20e)](_0x481ed5))return _0x4cde10[_0x45c9d3(0x1f2)](0x190)[_0x45c9d3(0x1fb)]({'error':_0x108eef['eknAy']});const _0x22481f=await reservasCol[_0x45c9d3(0x1f1)]({'barbero':_0x481ed5,'fecha':_0x36b51f,'hora':_0xb52a1e});if(_0x22481f)return _0x4cde10[_0x45c9d3(0x1f2)](0x190)['json']({'error':_0x108eef[_0x45c9d3(0x234)]});const _0x158a91={'nombreCliente':_0x1b2760,'numeroCelular':_0x2228ca,'barbero':_0x481ed5,'fecha':_0x36b51f,'hora':_0xb52a1e};await reservasCol[_0x45c9d3(0x1ee)](_0x158a91);const _0x232dc0=await clientesCol[_0x45c9d3(0x1f1)]({'numeroCelular':_0x2228ca});let _0x3090dc=0x1;if(_0x232dc0){const _0x5eb450=_0x232dc0[_0x45c9d3(0x211)]||0x0;_0x3090dc=_0x108eef[_0x45c9d3(0x23a)](_0x5eb450,0x8)?0x1:_0x108eef['HaGPf'](_0x5eb450,0x1),await clientesCol['updateOne']({'numeroCelular':_0x2228ca},{'$set':{'nombreCliente':_0x1b2760,'peluqueadas':_0x3090dc}});}else await clientesCol[_0x45c9d3(0x1ee)]({'numeroCelular':_0x2228ca,'nombreCliente':_0x1b2760,'peluqueadas':0x1});_0x4cde10[_0x45c9d3(0x1f2)](0xc9)[_0x45c9d3(0x1fb)]({'mensaje':_0x45c9d3(0x1f8),'reserva':_0x158a91,'peluqueadas':_0x3090dc});}),app[a1_0x16121f(0x23b)](a1_0x16121f(0x23e),async(_0x335f85,_0x31ae5e)=>{const _0x5ef356=a1_0x16121f,_0xf9a3e={'dYfmi':function(_0x24b9e9,_0x15dc5a){return _0x24b9e9||_0x15dc5a;},'EXunF':'Faltan\x20datos:\x20barbero,\x20fecha\x20u\x20horas','FXbWv':_0x5ef356(0x238),'IPeet':_0x5ef356(0x232)},{barbero:_0x13cf1c,fecha:_0x4adcd4,horas:_0x183dc0}=_0x335f85['body'];if(_0xf9a3e[_0x5ef356(0x1f4)](!_0x13cf1c,!_0x4adcd4)||!Array['isArray'](_0x183dc0))return _0x31ae5e[_0x5ef356(0x1f2)](0x190)[_0x5ef356(0x1fb)]({'error':_0xf9a3e[_0x5ef356(0x216)]});const _0x12adb0=[_0xf9a3e[_0x5ef356(0x210)],_0xf9a3e['IPeet']];if(!_0x12adb0['includes'](_0x13cf1c))return _0x31ae5e['status'](0x190)[_0x5ef356(0x1fb)]({'error':_0x5ef356(0x20c)});const _0x4be5c6=await disponibilidadesCol[_0x5ef356(0x20f)]({'barbero':_0x13cf1c,'fecha':_0x4adcd4},{'$addToSet':{'horas':{'$each':_0x183dc0}}},{'upsert':!![]});_0x31ae5e[_0x5ef356(0x1f2)](0xc9)[_0x5ef356(0x1fb)]({'mensaje':'Disponibilidad\x20actualizada\x20correctamente'});}),app['post'](a1_0x16121f(0x225),async(_0x15301b,_0x9b6658)=>{const _0x165c8e=a1_0x16121f,_0x4acc4e={'OhtuE':_0x165c8e(0x1f0),'YMWtk':_0x165c8e(0x214),'WkVhf':_0x165c8e(0x1fa),'xVADb':_0x165c8e(0x215),'UfMPX':'Error\x20del\x20servidor'},{usuario:_0x55a377,contrasena:_0x59a217}=_0x15301b['body'];if(!_0x55a377||!_0x59a217)return _0x9b6658['status'](0x190)['json']({'acceso':![],'mensaje':_0x4acc4e[_0x165c8e(0x218)]});try{const _0x22b5c6=db[_0x165c8e(0x231)](_0x4acc4e[_0x165c8e(0x227)]),_0xba453c=await _0x22b5c6[_0x165c8e(0x1f1)]({'usuario':_0x55a377,'contrasena':_0x59a217});return _0xba453c?_0x9b6658[_0x165c8e(0x1fb)]({'acceso':!![]}):_0x9b6658[_0x165c8e(0x1f2)](0x191)['json']({'acceso':![],'mensaje':_0x4acc4e['WkVhf']});}catch(_0x4c5db4){return console['error'](_0x4acc4e[_0x165c8e(0x220)],_0x4c5db4),_0x9b6658['status'](0x1f4)[_0x165c8e(0x1fb)]({'acceso':![],'mensaje':_0x4acc4e['UfMPX']});}}),app[a1_0x16121f(0x23b)](a1_0x16121f(0x20b),async(_0x5d5734,_0x2c66af)=>{const _0x3bb04b=a1_0x16121f,_0x3827f9={'arnsL':function(_0x513b3b,_0x3539b8){return _0x513b3b||_0x3539b8;},'NLwzd':function(_0x20633a,_0x25a07b){return _0x20633a===_0x25a07b;},'bytVP':_0x3bb04b(0x224),'TPQGK':'$peluqueadas','OWgxO':'Reserva\x20eliminada\x20y\x20cliente\x20actualizado','ZyBFl':_0x3bb04b(0x21d),'buBbs':_0x3bb04b(0x20d)},{barbero:_0x234d2a,fecha:_0x4efc7a,hora:_0x1d535b,numeroCelular:_0x3d34d2}=_0x5d5734['body'];if(_0x3827f9[_0x3bb04b(0x229)](!_0x234d2a,!_0x4efc7a)||!_0x1d535b||!_0x3d34d2)return _0x2c66af[_0x3bb04b(0x1f2)](0x190)[_0x3bb04b(0x1fb)]({'error':_0x3bb04b(0x1fd)});try{const _0x338deb=await reservasCol[_0x3bb04b(0x228)]({'barbero':_0x234d2a,'fecha':_0x4efc7a,'hora':_0x1d535b,'numeroCelular':_0x3d34d2});if(_0x3827f9['NLwzd'](_0x338deb[_0x3bb04b(0x242)],0x0))return _0x2c66af[_0x3bb04b(0x1f2)](0x194)[_0x3bb04b(0x1fb)]({'error':_0x3827f9[_0x3bb04b(0x23d)]});await clientesCol['updateOne']({'numeroCelular':_0x3d34d2},[{'$set':{'peluqueadas':{'$cond':[{'$gt':[_0x3827f9['TPQGK'],0x0]},{'$subtract':[_0x3827f9[_0x3bb04b(0x21f)],0x1]},0x0]}}}]),_0x2c66af[_0x3bb04b(0x1fb)]({'mensaje':_0x3827f9[_0x3bb04b(0x241)]});}catch(_0x3198a6){console[_0x3bb04b(0x202)](_0x3827f9[_0x3bb04b(0x23f)],_0x3198a6),_0x2c66af[_0x3bb04b(0x1f2)](0x1f4)[_0x3bb04b(0x1fb)]({'error':_0x3827f9[_0x3bb04b(0x235)]});}});