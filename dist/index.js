function a1_0x365f(){const _0x95e57f=['$peluqueadas','\x0aCelular:\x20','PMFrH','OHEZE','Reserva\x20no\x20encontrada','isArray','5432890EHglXx','gRLsx','trgbbrmghtdywhlk','749406GjzYed','listen','Horario\x20ya\x20reservado','wHeLM','PZoZl','❌\x20Error\x20al\x20enviar\x20correo:','BOAuW','maycamilo3@gmail.com','QxSzU','403256TrdZsC','clientes','Barbero\x20no\x20válido.\x20Solo\x20se\x20permiten\x20Juan\x20o\x20Camilo.','juandrp2004@gmail.com','disponibilidades','fAIcB','Nueva\x20reserva:\x0a\x0aCliente:\x20','map','deletedCount','QTNdv','use','collection','59400HgYgPx','hora','gmail','post','insertOne','zAFYA','reservas','findOne','🚀\x20Servidor\x20escuchando\x20en\x20http://localhost:3001','find','\x0aFecha:\x20','aCKkr','log','express','JIFZG','eWpqH','734811gIhtNP','Error\x20al\x20eliminar\x20la\x20reserva','cOZWY','10ciZvIc','Camilo','✉️\x20Correo\x20enviado:','/reservar','3MbaFLK','/clientes','/disponibilidad','/reservas/:fecha','HsCMj','json','body','then','\x0aHora:\x20','Faltan\x20datos:\x20nombre\x20cliente,numero\x20celular,\x20barbero,\x20fecha\x20u\x20hora','regaladas','updateOne','CkUCr','sKwLO','Faltan\x20datos:\x20barbero,\x20fecha,\x20hora\x20o\x20numeroCelular','peluqueadas','Error\x20del\x20servidor','3168iUcxfF','6201zlMpHN','Reserva\x20eliminada\x20y\x20cliente\x20actualizado','params','Hola\x20desde\x20Express\x20y\x20MongoDB\x20🚀','Faltan\x20datos','nysnq','includes','UYTLS','VqTKa','response','11RLGuQn','createTransport','nodemailer','admin','QqnOB','barberia.luxury.cj@gmail.com','Credenciales\x20inválidas','status','oceUH','/disponibilidad/:barbero/:fecha','qykfF','cors','toArray','UdMzt','/login','error','No\x20hay\x20disponibilidad\x20configurada','674605yFNPDQ','NsRaG','get','jYoMf','Disponibilidad\x20actualizada\x20correctamente','Juan','Faltan\x20datos:\x20barbero,\x20fecha\x20u\x20horas','./db','Error\x20al\x20eliminar\x20reserva:','CIcJc'];a1_0x365f=function(){return _0x95e57f;};return a1_0x365f();}const a1_0x46d390=a1_0x4de0;(function(_0x5ab0bf,_0x56c339){const _0x6f2f75=a1_0x4de0,_0x44c999=_0x5ab0bf();while(!![]){try{const _0x30226f=parseInt(_0x6f2f75(0x1b5))/0x1*(-parseInt(_0x6f2f75(0x1a2))/0x2)+-parseInt(_0x6f2f75(0x1b9))/0x3*(-parseInt(_0x6f2f75(0x196))/0x4)+-parseInt(_0x6f2f75(0x17a))/0x5+parseInt(_0x6f2f75(0x18d))/0x6+parseInt(_0x6f2f75(0x1b2))/0x7+-parseInt(_0x6f2f75(0x15e))/0x8*(parseInt(_0x6f2f75(0x15f))/0x9)+-parseInt(_0x6f2f75(0x18a))/0xa*(-parseInt(_0x6f2f75(0x169))/0xb);if(_0x30226f===_0x56c339)break;else _0x44c999['push'](_0x44c999['shift']());}catch(_0x4eb7d1){_0x44c999['push'](_0x44c999['shift']());}}}(a1_0x365f,0x294fc));const express=require(a1_0x46d390(0x1af)),app=express(),cors=require(a1_0x46d390(0x174)),conectarDB=require(a1_0x46d390(0x181)),nodemailer=require(a1_0x46d390(0x16b));app[a1_0x46d390(0x1a0)](cors()),app[a1_0x46d390(0x1a0)](express[a1_0x46d390(0x1be)]());function a1_0x4de0(_0x4f2365,_0x497318){const _0x365f01=a1_0x365f();return a1_0x4de0=function(_0x4de072,_0x1be816){_0x4de072=_0x4de072-0x15d;let _0x39ef78=_0x365f01[_0x4de072];return _0x39ef78;},a1_0x4de0(_0x4f2365,_0x497318);}let db,reservasCol,disponibilidadesCol,clientesCol;conectarDB()[a1_0x46d390(0x1c0)](_0x1514da=>{const _0x50c6ea=a1_0x46d390,_0x1da356={'oceUH':_0x50c6ea(0x1aa),'eWpqH':_0x50c6ea(0x19a),'OJZUE':_0x50c6ea(0x197)};db=_0x1514da,reservasCol=db[_0x50c6ea(0x1a1)](_0x50c6ea(0x1a8)),disponibilidadesCol=db[_0x50c6ea(0x1a1)](_0x1da356[_0x50c6ea(0x1b1)]),clientesCol=db[_0x50c6ea(0x1a1)](_0x1da356['OJZUE']),app[_0x50c6ea(0x18e)](0xbb9,()=>{const _0x4fe2e5=_0x50c6ea;console['log'](_0x1da356[_0x4fe2e5(0x171)]);});}),app[a1_0x46d390(0x17c)]('/',(_0x3410b4,_0x1d1cc7)=>{const _0x33e844=a1_0x46d390,_0x722b01={'gRLsx':_0x33e844(0x162)};_0x1d1cc7['send'](_0x722b01[_0x33e844(0x18b)]);}),app['get'](a1_0x46d390(0x172),async(_0x5b9a9e,_0x1fbd0a)=>{const _0x2e9c01=a1_0x46d390,_0x4619ba={'VqTKa':_0x2e9c01(0x17f),'ZKpcr':'Camilo','UYTLS':_0x2e9c01(0x198),'PMFrH':_0x2e9c01(0x179)},{barbero:_0x45aae6,fecha:_0x32c613}=_0x5b9a9e[_0x2e9c01(0x161)],_0x5e25ac=[_0x4619ba[_0x2e9c01(0x167)],_0x4619ba['ZKpcr']];if(!_0x5e25ac[_0x2e9c01(0x165)](_0x45aae6))return _0x1fbd0a[_0x2e9c01(0x170)](0x190)[_0x2e9c01(0x1be)]({'error':_0x4619ba[_0x2e9c01(0x166)]});const _0x9c1dcd=await disponibilidadesCol[_0x2e9c01(0x1a9)]({'barbero':_0x45aae6,'fecha':_0x32c613});if(!_0x9c1dcd)return _0x1fbd0a[_0x2e9c01(0x170)](0x194)[_0x2e9c01(0x1be)]({'error':_0x4619ba[_0x2e9c01(0x186)]});const _0x1f0123=await reservasCol[_0x2e9c01(0x1ab)]({'barbero':_0x45aae6,'fecha':_0x32c613})[_0x2e9c01(0x175)](),_0x3d062f=_0x1f0123[_0x2e9c01(0x19d)](_0x397d22=>_0x397d22[_0x2e9c01(0x1a3)]),_0x5d1d50=_0x9c1dcd['horas']['filter'](_0x2fe3a3=>!_0x3d062f[_0x2e9c01(0x165)](_0x2fe3a3));_0x1fbd0a['json']({'barbero':_0x45aae6,'fecha':_0x32c613,'disponibles':_0x5d1d50});}),app['get'](a1_0x46d390(0x1ba),async(_0x3fb73d,_0x1f06c3)=>{const _0x523006=a1_0x46d390,_0x487202={'iZWQO':_0x523006(0x197)},_0x35b0e8=await db[_0x523006(0x1a1)](_0x487202['iZWQO'])[_0x523006(0x1ab)]({})[_0x523006(0x175)]();_0x1f06c3[_0x523006(0x1be)](_0x35b0e8);}),app[a1_0x46d390(0x17c)](a1_0x46d390(0x1bc),async(_0x39f887,_0x3db90a)=>{const _0x57f826=a1_0x46d390,_0x30c0b9={'lnvFd':_0x57f826(0x1a8)},{fecha:_0x594dae}=_0x39f887[_0x57f826(0x161)],_0x5ad99c=await db[_0x57f826(0x1a1)](_0x30c0b9['lnvFd'])[_0x57f826(0x1ab)]({'fecha':_0x594dae})['toArray']();_0x3db90a['json'](_0x5ad99c);}),app[a1_0x46d390(0x1a5)](a1_0x46d390(0x1b8),async(_0x11b6d1,_0x448781)=>{const _0x3dbb1e=a1_0x46d390,_0x2544e9={'cOZWY':_0x3dbb1e(0x1b7),'yzFgM':function(_0x23337d,_0x79a9fb){return _0x23337d||_0x79a9fb;},'QqnOB':_0x3dbb1e(0x1c2),'wHeLM':'Juan','NsRaG':_0x3dbb1e(0x1b6),'QTNdv':_0x3dbb1e(0x198),'JIFZG':function(_0x51120b,_0xcde374){return _0x51120b+_0xcde374;},'PZoZl':function(_0x4d07fd,_0x3dd259){return _0x4d07fd+_0x3dd259;},'hVzyj':_0x3dbb1e(0x16e),'CIcJc':_0x3dbb1e(0x18c),'KOOEX':_0x3dbb1e(0x199),'qykfF':_0x3dbb1e(0x194),'sKwLO':'Reserva\x20realizada\x20con\x20éxito'},{nombreCliente:_0xcab1a5,numeroCelular:_0x4dd48c,barbero:_0x44e918,fecha:_0x460cdc,hora:_0x22dcc4}=_0x11b6d1[_0x3dbb1e(0x1bf)];if(_0x2544e9['yzFgM'](!_0xcab1a5,!_0x4dd48c)||!_0x44e918||!_0x460cdc||!_0x22dcc4)return _0x448781['status'](0x190)['json']({'error':_0x2544e9[_0x3dbb1e(0x16d)]});const _0x4ec64c=[_0x2544e9[_0x3dbb1e(0x190)],_0x2544e9[_0x3dbb1e(0x17b)]];if(!_0x4ec64c[_0x3dbb1e(0x165)](_0x44e918))return _0x448781['status'](0x190)[_0x3dbb1e(0x1be)]({'error':_0x2544e9[_0x3dbb1e(0x19f)]});const _0x3a984e=await reservasCol[_0x3dbb1e(0x1a9)]({'barbero':_0x44e918,'fecha':_0x460cdc,'hora':_0x22dcc4});if(_0x3a984e)return _0x448781[_0x3dbb1e(0x170)](0x190)['json']({'error':_0x3dbb1e(0x18f)});const _0x4bc934={'nombreCliente':_0xcab1a5,'numeroCelular':_0x4dd48c,'barbero':_0x44e918,'fecha':_0x460cdc,'hora':_0x22dcc4};await reservasCol[_0x3dbb1e(0x1a6)](_0x4bc934);const _0x4ecbf8=await clientesCol[_0x3dbb1e(0x1a9)]({'numeroCelular':_0x4dd48c});let _0x3edcba=0x1,_0x127ae0=0x0;if(_0x4ecbf8){const _0x39a63f=_0x4ecbf8[_0x3dbb1e(0x1c8)]||0x0,_0x561eb3=_0x4ecbf8[_0x3dbb1e(0x1c3)]||0x0;_0x39a63f>=0x7?(_0x3edcba=0x1,_0x127ae0=_0x2544e9[_0x3dbb1e(0x1b0)](_0x561eb3,0x1)):(_0x3edcba=_0x2544e9[_0x3dbb1e(0x191)](_0x39a63f,0x1),_0x127ae0=_0x561eb3),await clientesCol[_0x3dbb1e(0x1c4)]({'numeroCelular':_0x4dd48c},{'$set':{'nombreCliente':_0xcab1a5,'peluqueadas':_0x3edcba,'regaladas':_0x127ae0}});}else await clientesCol[_0x3dbb1e(0x1a6)]({'numeroCelular':_0x4dd48c,'nombreCliente':_0xcab1a5,'peluqueadas':0x1,'regaladas':0x0});const _0x57c70f=nodemailer[_0x3dbb1e(0x16a)]({'service':_0x3dbb1e(0x1a4),'auth':{'user':_0x2544e9['hVzyj'],'pass':_0x2544e9[_0x3dbb1e(0x183)]}}),_0x25094e={'from':_0x2544e9['hVzyj'],'to':[_0x2544e9['KOOEX'],_0x2544e9[_0x3dbb1e(0x173)]],'subject':'📅\x20Nueva\x20Reserva\x20en\x20Barbería\x20Luxury','text':_0x3dbb1e(0x19c)+_0xcab1a5+_0x3dbb1e(0x185)+_0x4dd48c+'\x0aBarbero:\x20'+_0x44e918+_0x3dbb1e(0x1ac)+_0x460cdc+_0x3dbb1e(0x1c1)+_0x22dcc4};_0x57c70f['sendMail'](_0x25094e,(_0x336420,_0x132a28)=>{const _0x51bc77=_0x3dbb1e;_0x336420?console[_0x51bc77(0x178)](_0x51bc77(0x192),_0x336420):console[_0x51bc77(0x1ae)](_0x2544e9[_0x51bc77(0x1b4)],_0x132a28[_0x51bc77(0x168)]);}),_0x448781[_0x3dbb1e(0x170)](0xc9)[_0x3dbb1e(0x1be)]({'mensaje':_0x2544e9[_0x3dbb1e(0x1c6)],'reserva':_0x4bc934,'peluqueadas':_0x3edcba,'regaladas':_0x127ae0});}),app[a1_0x46d390(0x1a5)](a1_0x46d390(0x1bb),async(_0x2579d0,_0x4499ac)=>{const _0x3c4ae5=a1_0x46d390,_0x108796={'PyPFj':function(_0x13841d,_0x118bf4){return _0x13841d||_0x118bf4;},'fAIcB':_0x3c4ae5(0x180),'HsCMj':_0x3c4ae5(0x17f),'nUrFz':_0x3c4ae5(0x1b6),'WtKlV':_0x3c4ae5(0x17e)},{barbero:_0xa05a30,fecha:_0x1f9691,horas:_0x5873cf}=_0x2579d0['body'];if(_0x108796['PyPFj'](!_0xa05a30,!_0x1f9691)||!Array[_0x3c4ae5(0x189)](_0x5873cf))return _0x4499ac[_0x3c4ae5(0x170)](0x190)[_0x3c4ae5(0x1be)]({'error':_0x108796[_0x3c4ae5(0x19b)]});const _0x289b39=[_0x108796[_0x3c4ae5(0x1bd)],_0x108796['nUrFz']];if(!_0x289b39[_0x3c4ae5(0x165)](_0xa05a30))return _0x4499ac[_0x3c4ae5(0x170)](0x190)[_0x3c4ae5(0x1be)]({'error':_0x3c4ae5(0x198)});const _0x3f0e33=await disponibilidadesCol['updateOne']({'barbero':_0xa05a30,'fecha':_0x1f9691},{'$addToSet':{'horas':{'$each':_0x5873cf}}},{'upsert':!![]});_0x4499ac['status'](0xc9)['json']({'mensaje':_0x108796['WtKlV']});}),app[a1_0x46d390(0x1a5)](a1_0x46d390(0x177),async(_0x12acc7,_0x3f8401)=>{const _0x3c8e92=a1_0x46d390,_0x303557={'OHEZE':function(_0x2e0766,_0x40ce0e){return _0x2e0766||_0x40ce0e;},'KnYKb':_0x3c8e92(0x163),'CkUCr':_0x3c8e92(0x16c),'jYoMf':_0x3c8e92(0x16f),'zRjRd':_0x3c8e92(0x15d)},{usuario:_0x4d791e,contrasena:_0x1f0a31}=_0x12acc7['body'];if(_0x303557[_0x3c8e92(0x187)](!_0x4d791e,!_0x1f0a31))return _0x3f8401[_0x3c8e92(0x170)](0x190)['json']({'acceso':![],'mensaje':_0x303557['KnYKb']});try{const _0x70a628=db[_0x3c8e92(0x1a1)](_0x303557[_0x3c8e92(0x1c5)]),_0x524ddb=await _0x70a628[_0x3c8e92(0x1a9)]({'usuario':_0x4d791e,'contrasena':_0x1f0a31});return _0x524ddb?_0x3f8401[_0x3c8e92(0x1be)]({'acceso':!![]}):_0x3f8401[_0x3c8e92(0x170)](0x191)[_0x3c8e92(0x1be)]({'acceso':![],'mensaje':_0x303557[_0x3c8e92(0x17d)]});}catch(_0x489a61){return console['error']('Error\x20en\x20login:',_0x489a61),_0x3f8401[_0x3c8e92(0x170)](0x1f4)['json']({'acceso':![],'mensaje':_0x303557['zRjRd']});}}),app['post']('/eliminarReserva',async(_0x55194e,_0x3e7a29)=>{const _0x16dc2a=a1_0x46d390,_0x54d921={'aCKkr':function(_0x58996e,_0x13aca8){return _0x58996e||_0x13aca8;},'QxSzU':_0x16dc2a(0x1c7),'nysnq':function(_0xdbc6e2,_0x17f181){return _0xdbc6e2===_0x17f181;},'YPnzZ':_0x16dc2a(0x188),'BOAuW':_0x16dc2a(0x160),'UdMzt':_0x16dc2a(0x182),'zAFYA':_0x16dc2a(0x1b3)},{barbero:_0x52ce8c,fecha:_0xb0346f,hora:_0x25b2a3,numeroCelular:_0x3401f5}=_0x55194e['body'];if(_0x54d921[_0x16dc2a(0x1ad)](!_0x52ce8c,!_0xb0346f)||!_0x25b2a3||!_0x3401f5)return _0x3e7a29[_0x16dc2a(0x170)](0x190)[_0x16dc2a(0x1be)]({'error':_0x54d921[_0x16dc2a(0x195)]});try{const _0x585c46=await reservasCol['deleteOne']({'barbero':_0x52ce8c,'fecha':_0xb0346f,'hora':_0x25b2a3,'numeroCelular':_0x3401f5});if(_0x54d921[_0x16dc2a(0x164)](_0x585c46[_0x16dc2a(0x19e)],0x0))return _0x3e7a29[_0x16dc2a(0x170)](0x194)[_0x16dc2a(0x1be)]({'error':_0x54d921['YPnzZ']});await clientesCol[_0x16dc2a(0x1c4)]({'numeroCelular':_0x3401f5},[{'$set':{'peluqueadas':{'$cond':[{'$gt':[_0x16dc2a(0x184),0x0]},{'$subtract':['$peluqueadas',0x1]},0x0]}}}]),_0x3e7a29[_0x16dc2a(0x1be)]({'mensaje':_0x54d921[_0x16dc2a(0x193)]});}catch(_0x7b87b8){console[_0x16dc2a(0x178)](_0x54d921[_0x16dc2a(0x176)],_0x7b87b8),_0x3e7a29[_0x16dc2a(0x170)](0x1f4)['json']({'error':_0x54d921[_0x16dc2a(0x1a7)]});}});