function a1_0x3c64(){const _0x29a34a=['mVIQI','Camilo','reservas','4323ecowWe','express','response','$peluqueadas','setApiKey','Prueba','insertOne','error','log','params','okkXy','GGdBb','deletedCount','3|4|0|2|1','peluqueadas','/ping','cTTVV','./db','Reserva\x20eliminada\x20y\x20cliente\x20actualizado','/login','DDuLP','üöÄ\x20Servidor\x20escuchando\x20en\x20http://localhost:3001','141360bQztEB','Reserva\x20realizada\x20con\x20√©xito','MSIda','gBkwd','MVyRu','BqqOF','12mYRkED','SENDGRID_API_KEY','/reservas/:fecha','\x20<br>üì±Celular:\x20','barberia.luxury.cj@gmail.com','Credenciales\x20inv√°lidas','status','üì®\x20Status\x20Code:','Faltan\x20datos:\x20nombre\x20cliente,numero\x20celular,\x20barbero,\x20fecha\x20u\x20hora','bVpeS','post','UvIGM','includes','maycamilo3@gmail.com','üéâNueva\x20reserva:\x20<br>üë§Cliente:\x20','findOne','lrAmU','find','isArray','VcaXU','SksHz','Horario\x20ya\x20reservado','Barbero\x20no\x20v√°lido.\x20Solo\x20se\x20permiten\x20Juan\x20o\x20Camilo.','use','deleteOne','get','json','Hola\x20desde\x20Express\x20y\x20MongoDB\x20üöÄ','MWZFN','dotenv','eMDqk','Correo\x20enviado','/disponibilidad','Error\x20en\x20login:','clientes','7UveyJp','2030808YaYRka','PmVpL','admin','updateOne','4806804JNQinK','OAOnx','sendStatus','fGxpQ','/disponibilidad/:barbero/:fecha','disponibilidades','tnwVC','855587qsUipB','send','collection','Intentar\x20enviar...','./middlewares/reservaLimiter','/clientes','9zSLziA','split','3370JmZMit','listen','BEkQP','FzgbG','body','\x20<br>‚è∞Hora:\x20','Juan','WbynK','then','@sendgrid/mail','\x20<br>üíàBarbero:\x20','Disponibilidad\x20actualizada\x20correctamente','No\x20hay\x20disponibilidad\x20configurada','eHmxe','/eliminarReserva','filter','‚ùå\x20Error\x20al\x20enviar\x20correo:','bgvuc','juandrp2004@gmail.com','WYQkL','Error\x20al\x20eliminar\x20reserva:','toArray','Faltan\x20datos:\x20barbero,\x20fecha\x20u\x20horas','hora','DHFsD','9151040mANylK','743058bTHzwH'];a1_0x3c64=function(){return _0x29a34a;};return a1_0x3c64();}const a1_0x3591b5=a1_0x47df;(function(_0x26cc61,_0x23bfce){const _0x2ac13e=a1_0x47df,_0x892c5f=_0x26cc61();while(!![]){try{const _0x53c407=parseInt(_0x2ac13e(0xdd))/0x1+-parseInt(_0x2ac13e(0xae))/0x2*(parseInt(_0x2ac13e(0xff))/0x3)+-parseInt(_0x2ac13e(0xd2))/0x4+parseInt(_0x2ac13e(0xa8))/0x5+-parseInt(_0x2ac13e(0xd6))/0x6*(-parseInt(_0x2ac13e(0xd1))/0x7)+-parseInt(_0x2ac13e(0xfe))/0x8*(-parseInt(_0x2ac13e(0xe3))/0x9)+parseInt(_0x2ac13e(0xe5))/0xa*(parseInt(_0x2ac13e(0x103))/0xb);if(_0x53c407===_0x23bfce)break;else _0x892c5f['push'](_0x892c5f['shift']());}catch(_0xe07fa5){_0x892c5f['push'](_0x892c5f['shift']());}}}(a1_0x3c64,0xec348));const express=require(a1_0x3591b5(0x104)),app=express(),cors=require('cors'),conectarDB=require(a1_0x3591b5(0xa3)),sgMail=require(a1_0x3591b5(0xee)),reservaLimiter=require(a1_0x3591b5(0xe1));require(a1_0x3591b5(0xcb))['config'](),sgMail[a1_0x3591b5(0x107)](process['env'][a1_0x3591b5(0xaf)]),app[a1_0x3591b5(0xc5)](cors()),app[a1_0x3591b5(0xc5)](express[a1_0x3591b5(0xc8)]()),app['set']('trust\x20proxy',0x1);let db,reservasCol,disponibilidadesCol,clientesCol;function a1_0x47df(_0x37e721,_0x1d4cb9){const _0x3c642b=a1_0x3c64();return a1_0x47df=function(_0x47df44,_0x54c29b){_0x47df44=_0x47df44-0xa1;let _0x354754=_0x3c642b[_0x47df44];return _0x354754;},a1_0x47df(_0x37e721,_0x1d4cb9);}conectarDB()[a1_0x3591b5(0xed)](_0x5b8782=>{const _0x1cef0d=a1_0x3591b5,_0x152b73={'bgvuc':_0x1cef0d(0x110),'MSIda':_0x1cef0d(0xdb),'DDuLP':'clientes'},_0x52bc0f=_0x152b73[_0x1cef0d(0xf6)][_0x1cef0d(0xe4)]('|');let _0x5b31bc=0x0;while(!![]){switch(_0x52bc0f[_0x5b31bc++]){case'0':disponibilidadesCol=db[_0x1cef0d(0xdf)](_0x152b73[_0x1cef0d(0xaa)]);continue;case'1':app[_0x1cef0d(0xe6)](0xbb9,()=>{const _0x518182=_0x1cef0d;console[_0x518182(0x10b)](_0x518182(0xa7));});continue;case'2':clientesCol=db['collection'](_0x152b73[_0x1cef0d(0xa6)]);continue;case'3':db=_0x5b8782;continue;case'4':reservasCol=db[_0x1cef0d(0xdf)](_0x1cef0d(0x102));continue;}break;}}),app[a1_0x3591b5(0xc7)](a1_0x3591b5(0xa1),(_0x5d68ab,_0x652c67)=>_0x652c67[a1_0x3591b5(0xd8)](0xc8)),app[a1_0x3591b5(0xc7)]('/',(_0x481d7f,_0x1ba248)=>{const _0x1f447a=a1_0x3591b5,_0xe683bf={'WbynK':_0x1f447a(0xc9)};_0x1ba248[_0x1f447a(0xde)](_0xe683bf[_0x1f447a(0xec)]);}),app[a1_0x3591b5(0xc7)](a1_0x3591b5(0xda),async(_0x44d31a,_0x489285)=>{const _0x36b38d=a1_0x3591b5,_0x584dc9={'BqqOF':_0x36b38d(0xeb),'Pxukz':_0x36b38d(0xc4),'bQNlJ':_0x36b38d(0xf1)},{barbero:_0x5d2e5e,fecha:_0x29cada}=_0x44d31a[_0x36b38d(0x10c)],_0x5455e4=[_0x584dc9[_0x36b38d(0xad)],'Camilo'];if(!_0x5455e4[_0x36b38d(0xba)](_0x5d2e5e))return _0x489285['status'](0x190)['json']({'error':_0x584dc9['Pxukz']});const _0x4c417c=await disponibilidadesCol[_0x36b38d(0xbd)]({'barbero':_0x5d2e5e,'fecha':_0x29cada});if(!_0x4c417c)return _0x489285[_0x36b38d(0xb4)](0x194)[_0x36b38d(0xc8)]({'error':_0x584dc9['bQNlJ']});const _0x490598=await reservasCol[_0x36b38d(0xbf)]({'barbero':_0x5d2e5e,'fecha':_0x29cada})['toArray'](),_0x203107=_0x490598['map'](_0x40a42d=>_0x40a42d[_0x36b38d(0xfc)]),_0x1e3bf3=_0x4c417c['horas'][_0x36b38d(0xf4)](_0x14a7ec=>!_0x203107['includes'](_0x14a7ec));_0x489285[_0x36b38d(0xc8)]({'barbero':_0x5d2e5e,'fecha':_0x29cada,'disponibles':_0x1e3bf3});}),app['get'](a1_0x3591b5(0xe2),async(_0x47d90d,_0x42622e)=>{const _0x4d82e8=a1_0x3591b5,_0x143cf2={'hfaHE':_0x4d82e8(0xd0)},_0x2d01cb=await db[_0x4d82e8(0xdf)](_0x143cf2['hfaHE'])[_0x4d82e8(0xbf)]({})[_0x4d82e8(0xfa)]();_0x42622e[_0x4d82e8(0xc8)](_0x2d01cb);}),app[a1_0x3591b5(0xc7)](a1_0x3591b5(0xb0),async(_0x2232ac,_0x56222f)=>{const _0x48d6bd=a1_0x3591b5,_0x2141dd={'gBkwd':_0x48d6bd(0x102)},{fecha:_0x36b39d}=_0x2232ac[_0x48d6bd(0x10c)],_0xf09514=await db[_0x48d6bd(0xdf)](_0x2141dd[_0x48d6bd(0xab)])[_0x48d6bd(0xbf)]({'fecha':_0x36b39d})[_0x48d6bd(0xfa)]();_0x56222f[_0x48d6bd(0xc8)](_0xf09514);}),app[a1_0x3591b5(0xb8)]('/reservar',reservaLimiter,async(_0x1f2312,_0x382319)=>{const _0x3664dd=a1_0x3591b5,_0x53f03f={'cTTVV':function(_0x1dd461,_0x2357f5){return _0x1dd461||_0x2357f5;},'BEkQP':_0x3664dd(0xb6),'fGxpQ':_0x3664dd(0x101),'lrAmU':_0x3664dd(0xc3),'rYsVU':function(_0x221ce1,_0x4f86ad){return _0x221ce1>=_0x4f86ad;},'PmVpL':function(_0x337c9d,_0x297cb6){return _0x337c9d+_0x297cb6;},'SksHz':_0x3664dd(0xbb),'okkXy':_0x3664dd(0xb2),'MWZFN':_0x3664dd(0xf7),'tnwVC':_0x3664dd(0x108),'VcaXU':_0x3664dd(0xe0),'eHmxe':_0x3664dd(0xb5),'yvWJI':_0x3664dd(0xf5),'FzgbG':_0x3664dd(0xa9)},{nombreCliente:_0x30b254,numeroCelular:_0x49ff90,barbero:_0x2e1dc9,fecha:_0x47700f,hora:_0x5f0f9b}=_0x1f2312[_0x3664dd(0xe9)];if(_0x53f03f[_0x3664dd(0xa2)](!_0x30b254,!_0x49ff90)||!_0x2e1dc9||!_0x47700f||!_0x5f0f9b)return _0x382319[_0x3664dd(0xb4)](0x190)[_0x3664dd(0xc8)]({'error':_0x53f03f[_0x3664dd(0xe7)]});const _0x158c18=[_0x3664dd(0xeb),_0x53f03f[_0x3664dd(0xd9)]];if(!_0x158c18[_0x3664dd(0xba)](_0x2e1dc9))return _0x382319[_0x3664dd(0xb4)](0x190)[_0x3664dd(0xc8)]({'error':_0x3664dd(0xc4)});const _0x4e38ae=await reservasCol[_0x3664dd(0xbd)]({'barbero':_0x2e1dc9,'fecha':_0x47700f,'hora':_0x5f0f9b});if(_0x4e38ae)return _0x382319['status'](0x190)[_0x3664dd(0xc8)]({'error':_0x53f03f[_0x3664dd(0xbe)]});const _0x40a2c7={'nombreCliente':_0x30b254,'numeroCelular':_0x49ff90,'barbero':_0x2e1dc9,'fecha':_0x47700f,'hora':_0x5f0f9b};await reservasCol[_0x3664dd(0x109)](_0x40a2c7);const _0x18a250=await clientesCol[_0x3664dd(0xbd)]({'numeroCelular':_0x49ff90});let _0xe1af34=0x1,_0x1b8f8b=0x0;if(_0x18a250){const _0x35daed=_0x18a250[_0x3664dd(0x111)]||0x0,_0x1d75e6=_0x18a250['regaladas']||0x0;_0x53f03f['rYsVU'](_0x35daed,0x7)?(_0xe1af34=0x1,_0x1b8f8b=_0x1d75e6+0x1):(_0xe1af34=_0x53f03f[_0x3664dd(0xd3)](_0x35daed,0x1),_0x1b8f8b=_0x1d75e6),await clientesCol[_0x3664dd(0xd5)]({'numeroCelular':_0x49ff90},{'$set':{'nombreCliente':_0x30b254,'peluqueadas':_0xe1af34,'regaladas':_0x1b8f8b}});}else await clientesCol['insertOne']({'numeroCelular':_0x49ff90,'nombreCliente':_0x30b254,'peluqueadas':0x1,'regaladas':0x0});const _0x12aeeb={'to':_0x53f03f[_0x3664dd(0xc2)],'from':_0x53f03f[_0x3664dd(0x10d)],'cc':_0x53f03f[_0x3664dd(0xca)],'subject':'üìÖ\x20Nueva\x20Reserva\x20en\x20Barber√≠a\x20Luxury','text':_0x53f03f[_0x3664dd(0xdc)],'html':_0x3664dd(0xbc)+_0x30b254+_0x3664dd(0xb1)+_0x49ff90+_0x3664dd(0xef)+_0x2e1dc9+'\x20<br>üìÖFecha:\x20'+_0x47700f+_0x3664dd(0xea)+_0x5f0f9b};try{console['log'](_0x53f03f[_0x3664dd(0xc1)]);const [_0x1bfc3f]=await sgMail[_0x3664dd(0xde)](_0x12aeeb);console[_0x3664dd(0x10b)](_0x53f03f[_0x3664dd(0xf2)],_0x1bfc3f['statusCode']),console['log'](_0x3664dd(0xcd));}catch(_0x31119a){console[_0x3664dd(0x10a)](_0x53f03f['yvWJI'],_0x31119a[_0x3664dd(0x105)]?.['body']||_0x31119a);}_0x382319[_0x3664dd(0xb4)](0xc9)[_0x3664dd(0xc8)]({'mensaje':_0x53f03f[_0x3664dd(0xe8)],'reserva':_0x40a2c7,'peluqueadas':_0xe1af34,'regaladas':_0x1b8f8b});}),app['post'](a1_0x3591b5(0xce),async(_0x4cbbaa,_0x32fadc)=>{const _0x117cad=a1_0x3591b5,_0x208632={'GGdBb':_0x117cad(0xfb),'NFBRg':'Juan','mVIQI':_0x117cad(0xc4)},{barbero:_0x2827b8,fecha:_0x50530b,horas:_0x16bd47}=_0x4cbbaa[_0x117cad(0xe9)];if(!_0x2827b8||!_0x50530b||!Array[_0x117cad(0xc0)](_0x16bd47))return _0x32fadc[_0x117cad(0xb4)](0x190)[_0x117cad(0xc8)]({'error':_0x208632[_0x117cad(0x10e)]});const _0x5a5754=[_0x208632['NFBRg'],_0x117cad(0x101)];if(!_0x5a5754[_0x117cad(0xba)](_0x2827b8))return _0x32fadc['status'](0x190)[_0x117cad(0xc8)]({'error':_0x208632[_0x117cad(0x100)]});const _0x38ba5a=await disponibilidadesCol[_0x117cad(0xd5)]({'barbero':_0x2827b8,'fecha':_0x50530b},{'$addToSet':{'horas':{'$each':_0x16bd47}}},{'upsert':!![]});_0x32fadc['status'](0xc9)['json']({'mensaje':_0x117cad(0xf0)});}),app[a1_0x3591b5(0xb8)](a1_0x3591b5(0xa5),async(_0x471bcc,_0xf81e23)=>{const _0x46fc69=a1_0x3591b5,_0x42d287={'eMDqk':function(_0x26d86f,_0x36353e){return _0x26d86f||_0x36353e;},'WYQkL':'Faltan\x20datos','cUpDH':_0x46fc69(0xd4),'DHFsD':_0x46fc69(0xcf),'FvUMG':'Error\x20del\x20servidor'},{usuario:_0x2aa50b,contrasena:_0x1f9a38}=_0x471bcc['body'];if(_0x42d287[_0x46fc69(0xcc)](!_0x2aa50b,!_0x1f9a38))return _0xf81e23[_0x46fc69(0xb4)](0x190)['json']({'acceso':![],'mensaje':_0x42d287[_0x46fc69(0xf8)]});try{const _0x19dea4=db[_0x46fc69(0xdf)](_0x42d287['cUpDH']),_0x5cdf70=await _0x19dea4['findOne']({'usuario':_0x2aa50b,'contrasena':_0x1f9a38});return _0x5cdf70?_0xf81e23[_0x46fc69(0xc8)]({'acceso':!![]}):_0xf81e23[_0x46fc69(0xb4)](0x191)[_0x46fc69(0xc8)]({'acceso':![],'mensaje':_0x46fc69(0xb3)});}catch(_0x40db7b){return console[_0x46fc69(0x10a)](_0x42d287[_0x46fc69(0xfd)],_0x40db7b),_0xf81e23['status'](0x1f4)['json']({'acceso':![],'mensaje':_0x42d287['FvUMG']});}}),app[a1_0x3591b5(0xb8)](a1_0x3591b5(0xf3),async(_0x74000,_0x2ae0d6)=>{const _0x4a8da9=a1_0x3591b5,_0x389e5f={'OAOnx':function(_0x4140c4,_0xc8572){return _0x4140c4||_0xc8572;},'Cndix':'Faltan\x20datos:\x20barbero,\x20fecha,\x20hora\x20o\x20numeroCelular','UvIGM':function(_0x32158e,_0x36daae){return _0x32158e===_0x36daae;},'PYQkF':'Reserva\x20no\x20encontrada','bVpeS':_0x4a8da9(0x106),'MVyRu':'Error\x20al\x20eliminar\x20la\x20reserva'},{barbero:_0x320119,fecha:_0x557b45,hora:_0x3aa184,numeroCelular:_0x2054b3}=_0x74000[_0x4a8da9(0xe9)];if(_0x389e5f[_0x4a8da9(0xd7)](!_0x320119,!_0x557b45)||!_0x3aa184||!_0x2054b3)return _0x2ae0d6['status'](0x190)['json']({'error':_0x389e5f['Cndix']});try{const _0x113047=await reservasCol[_0x4a8da9(0xc6)]({'barbero':_0x320119,'fecha':_0x557b45,'hora':_0x3aa184,'numeroCelular':_0x2054b3});if(_0x389e5f[_0x4a8da9(0xb9)](_0x113047[_0x4a8da9(0x10f)],0x0))return _0x2ae0d6['status'](0x194)[_0x4a8da9(0xc8)]({'error':_0x389e5f['PYQkF']});await clientesCol[_0x4a8da9(0xd5)]({'numeroCelular':_0x2054b3},[{'$set':{'peluqueadas':{'$cond':[{'$gt':[_0x389e5f['bVpeS'],0x0]},{'$subtract':[_0x389e5f[_0x4a8da9(0xb7)],0x1]},0x0]}}}]),_0x2ae0d6['json']({'mensaje':_0x4a8da9(0xa4)});}catch(_0x12275d){console[_0x4a8da9(0x10a)](_0x4a8da9(0xf9),_0x12275d),_0x2ae0d6[_0x4a8da9(0xb4)](0x1f4)[_0x4a8da9(0xc8)]({'error':_0x389e5f[_0x4a8da9(0xac)]});}});